Below is the final, complete functional tutorial with the critical step of updating **app/index.js** moved into the early Expo setup section—so you’ll know right away to replace the default home screen code.

---

# Complete Functional Tutorial for ScriptHammer

This guide will help you build your mobile app framework using Expo Router, Supabase, NativeWind, Storybook, and Jest testing. The Supabase backend is set up first, then you initialize your Expo project with the modern **app/** directory (which replaces the old **App.js**). Every file is provided as complete, functional code. A terminal script at the end automates file creation.

> **Important:**  
> – Run the Supabase SQL commands in your Supabase dashboard before beginning the Expo project.  
> – **Critical:** When your project is created, you must replace the default contents of **app/index.js** with the provided HomeScreen code.

---

## Table of Contents

1. [Supabase Integration & Backend Setup](#1-supabase-integration--backend-setup)  
   1.1. [Authentication and Role Assignment](#11-authentication-and-role-assignment)  
   1.2. [Database Schema and API Service Layer](#12-database-schema-and-api-service-layer)  
2. [Initial Expo Setup & Critical HomeScreen Update](#2-initial-expo-setup--critical-homescreen-update)  
   2.1. [Expo Project Initialization](#21-expo-project-initialization)  
   2.2. [Updating app/index.js](#22-updating-appindexjs)  
3. [Building the Admin Dashboard](#3-building-the-admin-dashboard)  
4. [Implementing Social Network Features](#4-implementing-social-network-features)  
   4.1. [Posts Component](#41-posts-component)  
   4.2. [Chat Component](#42-chat-component)  
5. [Developer Experience Tools](#5-developer-experience-tools)  
   5.1. [Storybook Setup](#51-storybook-setup)  
   5.2. [Testing Setup](#52-testing-setup)  
6. [CRUD Scaffolding Interface](#6-crud-scaffolding-interface)  
7. [Terminal Setup Script](#7-terminal-setup-script)  
8. [Recommended Folder Structure](#8-recommended-folder-structure)

---

## 1. Supabase Integration & Backend Setup

### 1.1 Authentication and Role Assignment

Run these SQL commands in your Supabase dashboard to create a table for user roles and a trigger that assigns roles (the first user becomes “admin” and subsequent users become “user”):

```sql
-- Create a table for user roles
create table if not exists public.user_roles (
  user_id uuid primary key,
  role text not null,
  created_at timestamp with time zone default now()
);

-- Create a function to assign roles automatically
create or replace function public.assign_role()
returns trigger as $$
declare
  admin_count int;
begin
  select count(*) into admin_count from public.user_roles where role = 'admin';
  if admin_count = 0 then
    insert into public.user_roles(user_id, role) values (new.id, 'admin');
  else
    insert into public.user_roles(user_id, role) values (new.id, 'user');
  end if;
  return new;
end;
$$ language plpgsql;

-- Create the trigger after user insertion
drop trigger if exists assign_role_trigger on auth.users;
create trigger assign_role_trigger
after insert on auth.users
for each row execute function public.assign_role();
```

### 1.2 Database Schema and API Service Layer

Run these SQL commands to create tables for posts, chats, and CRUD operations:

```sql
-- Create posts table
create table if not exists public.posts (
  id uuid primary key default gen_random_uuid(),
  user_id uuid references auth.users(id),
  content text not null,
  created_at timestamp with time zone default now()
);

-- Create chats table
create table if not exists public.chats (
  id uuid primary key default gen_random_uuid(),
  sender_id uuid references auth.users(id),
  receiver_id uuid references auth.users(id),
  message text not null,
  created_at timestamp with time zone default now()
);

-- Create table for CRUD operations
create table if not exists public.crud_items (
  id uuid primary key default gen_random_uuid(),
  content text not null,
  created_at timestamp with time zone default now()
);
```

Now add the service layer files to your project:

**File: services/apiService.js**

```javascript
// services/apiService.js
import { supabase } from './supabaseClient';

// Posts API
export const fetchPosts = async () => {
  const { data, error } = await supabase
    .from('posts')
    .select('*')
    .order('created_at', { ascending: false });
  if (error) {
    console.error('Error fetching posts:', error);
    throw error;
  }
  return data;
};

export const createPost = async (content) => {
  const { data, error } = await supabase
    .from('posts')
    .insert([{ content }]);
  if (error) {
    console.error('Error creating post:', error);
    throw error;
  }
  return data;
};

// Chats API
export const fetchChats = async () => {
  const { data, error } = await supabase
    .from('chats')
    .select('*')
    .order('created_at');
  if (error) {
    console.error('Error fetching chats:', error);
    throw error;
  }
  return data;
};

export const createChatMessage = async (message) => {
  const { data, error } = await supabase
    .from('chats')
    .insert([{ message }]);
  if (error) {
    console.error('Error creating chat message:', error);
    throw error;
  }
  return data;
};
```

**File: services/supabaseClient.js**

```javascript
// services/supabaseClient.js
import { createClient } from '@supabase/supabase-js';
import { APP_CONFIG } from '../config/config';

const supabaseUrl = APP_CONFIG.supabaseUrl;
const supabaseAnonKey = APP_CONFIG.supabaseAnonKey;

export const supabase = createClient(supabaseUrl, supabaseAnonKey);
```

---

## 2. Initial Expo Setup & Critical HomeScreen Update

### 2.1 Expo Project Initialization

Initialize your Expo project with Expo Router by running these commands in your terminal:

```bash
npx create-expo-app ScriptHammer
cd ScriptHammer
npm run reset-project
rm -rf app-example
```

Then, create a configuration file:

**File: config/config.js**

```javascript
// config/config.js
export const APP_CONFIG = {
  projectName: 'ScriptHammer',
  supabaseUrl: process.env.EXPO_PUBLIC_SUPABASE_URL || 'https://wbltsbyjnyraeaqumkcu.supabase.co',
  supabaseAnonKey: process.env.EXPO_PUBLIC_SUPABASE_ANON_KEY || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndibHRzYnlqbnlyYWVhcXVta2N1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzgzNzM1ODksImV4cCI6MjA1Mzk0OTU4OX0.gMqIQ7xIC2zSiwDbbdt6RClZMIkSDQqIJxYzAtdcziY',
};
```

### 2.2 **Critical: Update app/index.js**

After your project is created, the default **app/index.js** file must be replaced to display your custom HomeScreen.  
**Follow these steps:**

1. **Open `app/index.js`** in your code editor.
2. **Delete all the default content** (from line 1 to the end).
3. **Paste the following code starting at line 1:**

   ```javascript
   // app/index.js
   import React from 'react';
   import { View } from 'react-native';
   import PostList from '../components/PostList';
   import ChatComponent from '../components/ChatComponent';
   import CrudInterface from '../components/CrudInterface';

   export default function HomeScreen() {
     return (
       <View style={{ flex: 1, padding: 16 }}>
         <PostList />
         <ChatComponent />
         <CrudInterface />
       </View>
     );
   }
   ```

This step is essential so that your home route shows our custom components instead of the default template.

---

## 3. Building the Admin Dashboard

Create a reusable admin dashboard component:

**File: components/AdminDashboard.js**

```javascript
// components/AdminDashboard.js
import React, { useContext } from 'react';
import { View, Text, Button } from 'react-native';
import { UserContext } from '../contexts/UserContext';

const AdminDashboard = () => {
  const { role } = useContext(UserContext);

  if (role !== 'admin') {
    return (
      <View className="p-4">
        <Text className="text-red-500 text-xl">Access Denied</Text>
        <Text>You do not have admin privileges.</Text>
      </View>
    );
  }

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">Admin Dashboard</Text>
      <Button title="Refresh Data" onPress={() => { /* Refresh logic here */ }} />
    </View>
  );
};

export default AdminDashboard;
```

Then, create the admin route:

**File: app/admin/index.js**

```javascript
// app/admin/index.js
import React from 'react';
import AdminDashboard from '../../components/AdminDashboard';

export default function AdminScreen() {
  return <AdminDashboard />;
}
```

---

## 4. Implementing Social Network Features

### 4.1 Posts Component

Create a component for listing and creating posts:

**File: components/PostList.js**

```javascript
// components/PostList.js
import React, { useEffect, useState } from 'react';
import { View, Text, FlatList, Button } from 'react-native';
import { fetchPosts, createPost } from '../services/apiService';

const PostList = () => {
  const [posts, setPosts] = useState([]);

  const loadPosts = async () => {
    try {
      const data = await fetchPosts();
      setPosts(data);
    } catch (error) {
      console.error('Error loading posts:', error);
    }
  };

  useEffect(() => {
    loadPosts();
  }, []);

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">Posts</Text>
      <FlatList
        data={posts}
        keyExtractor={(item) => item.id}
        renderItem={({ item }) => (
          <View className="mb-2 p-2 border rounded">
            <Text>{item.content}</Text>
          </View>
        )}
      />
      <Button title="New Post" onPress={() => createPost("Sample post content").then(loadPosts)} />
    </View>
  );
};

export default PostList;
```

### 4.2 Chat Component

Create a real‑time chat component:

**File: components/ChatComponent.js**

```javascript
// components/ChatComponent.js
import React, { useEffect, useState } from 'react';
import { View, Text, FlatList, TextInput, Button } from 'react-native';
import { supabase } from '../services/supabaseClient';
import { createChatMessage, fetchChats } from '../services/apiService';

const ChatComponent = () => {
  const [messages, setMessages] = useState([]);
  const [newMessage, setNewMessage] = useState('');

  const loadMessages = async () => {
    try {
      const data = await fetchChats();
      setMessages(data);
    } catch (error) {
      console.error('Error loading messages:', error);
    }
  };

  const sendMessage = async () => {
    if (!newMessage) return;
    try {
      await createChatMessage(newMessage);
      setNewMessage('');
    } catch (error) {
      console.error('Error sending message:', error);
    }
  };

  useEffect(() => {
    loadMessages();
    const subscription = supabase
      .from('chats')
      .on('INSERT', payload => {
        setMessages((prev) => [...prev, payload.new]);
      })
      .subscribe();

    return () => {
      supabase.removeSubscription(subscription);
    };
  }, []);

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">Chat</Text>
      <FlatList
        data={messages}
        keyExtractor={(item) => item.id}
        renderItem={({ item }) => (
          <View className="mb-2 p-2 border rounded">
            <Text>{item.message}</Text>
          </View>
        )}
      />
      <TextInput 
        value={newMessage}
        onChangeText={setNewMessage}
        placeholder="Type your message..."
        className="border p-2 mb-2"
      />
      <Button title="Send" onPress={sendMessage} />
    </View>
  );
};

export default ChatComponent;
```

---

## 5. Developer Experience Tools

### 5.1 Storybook Setup

Configure Storybook:

**File: .storybook/main.js**

```javascript
// .storybook/main.js
module.exports = {
  stories: ['../components/**/*.stories.@(js|jsx|ts|tsx)'],
  addons: [
    '@storybook/addon-links',
    '@storybook/addon-essentials',
  ],
};
```

Add a sample story:

**File: components/Button.stories.js**

```javascript
// components/Button.stories.js
import React from 'react';
import { Button } from 'react-native';
import { storiesOf } from '@storybook/react-native';

storiesOf('Button', module)
  .add('default', () => (
    <Button title="Click Me" onPress={() => {}} />
  ));
```

### 5.2 Testing Setup

Set up Jest testing:

**File: tests/App.test.js**

```javascript
// tests/App.test.js
import React from 'react';
import renderer from 'react-test-renderer';
import RootLayout from '../app/_layout';

it('renders correctly', () => {
  const tree = renderer.create(<RootLayout />).toJSON();
  expect(tree).toMatchSnapshot();
});
```

**File: jest.config.js**

```javascript
// jest.config.js
module.exports = {
  preset: 'jest-expo',
  transform: {
    '^.+\\.js$': '<rootDir>/node_modules/react-native/jest/preprocessor.js',
  },
  setupFiles: ['./tests/jest.setup.js'],
};
```

**File: tests/jest.setup.js**

```javascript
// tests/jest.setup.js
import 'react-native-gesture-handler/jestSetup';
```

---

## 6. CRUD Scaffolding Interface

Create the CRUD interface component:

**File: components/CrudInterface.js**

```javascript
// components/CrudInterface.js
import React, { useState, useEffect } from 'react';
import { View, Text, TextInput, Button, FlatList } from 'react-native';
import { supabase } from '../services/supabaseClient';

const CrudInterface = () => {
  const [items, setItems] = useState([]);
  const [newItem, setNewItem] = useState('');
  const [editItemId, setEditItemId] = useState(null);
  const [editText, setEditText] = useState('');

  const fetchItems = async () => {
    const { data, error } = await supabase
      .from('crud_items')
      .select('*')
      .order('created_at', { ascending: false });
    if (error) {
      console.error('Error fetching items:', error);
    } else {
      setItems(data);
    }
  };

  const createItem = async () => {
    if (!newItem) return;
    const { data, error } = await supabase
      .from('crud_items')
      .insert([{ content: newItem }]);
    if (error) {
      console.error('Error creating item:', error);
    } else {
      setNewItem('');
      fetchItems();
    }
  };

  const updateItem = async () => {
    if (!editText || !editItemId) return;
    const { data, error } = await supabase
      .from('crud_items')
      .update({ content: editText })
      .eq('id', editItemId);
    if (error) {
      console.error('Error updating item:', error);
    } else {
      setEditItemId(null);
      setEditText('');
      fetchItems();
    }
  };

  const deleteItem = async (id) => {
    const { data, error } = await supabase
      .from('crud_items')
      .delete()
      .eq('id', id);
    if (error) {
      console.error('Error deleting item:', error);
    } else {
      fetchItems();
    }
  };

  useEffect(() => {
    fetchItems();
  }, []);

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">CRUD Scaffolding Interface</Text>
      <TextInput 
        value={newItem}
        onChangeText={setNewItem}
        placeholder="New item content"
        className="border p-2 mb-2"
      />
      <Button title="Add Item" onPress={createItem} />
      <FlatList
        data={items}
        keyExtractor={(item) => item.id}
        renderItem={({ item }) => (
          <View className="my-2 p-2 border rounded">
            <Text>{item.content}</Text>
            <Button title="Edit" onPress={() => { setEditItemId(item.id); setEditText(item.content); }} />
            <Button title="Delete" onPress={() => deleteItem(item.id)} />
          </View>
        )}
      />
      {editItemId && (
        <View className="mt-4">
          <Text>Edit Item</Text>
          <TextInput 
            value={editText}
            onChangeText={setEditText}
            placeholder="Edit item content"
            className="border p-2 mb-2"
          />
          <Button title="Update Item" onPress={updateItem} />
        </View>
      )}
    </View>
  );
};

export default CrudInterface;
```

---

## 7. Terminal Setup Script

Below is the shell script to automatically create the complete project structure and files. (Remember to run the Supabase SQL commands manually in your Supabase dashboard before running this script.) The script overwrites the default **app/index.js** with our custom HomeScreen code.

```bash
#!/bin/bash
# --- Terminal Setup Script for ScriptHammer Mobile App Framework ---

# Step 1: Create and setup the Expo project with Expo Router
npx create-expo-app ScriptHammer
cd ScriptHammer
npm run reset-project
rm -rf app-example

# Step 2: Create configuration and Supabase client files
mkdir -p config services components app/contexts app/tests

cat > config/config.js << 'EOF'
export const APP_CONFIG = {
  projectName: 'ScriptHammer',
  supabaseUrl: process.env.EXPO_PUBLIC_SUPABASE_URL || 'https://wbltsbyjnyraeaqumkcu.supabase.co',
  supabaseAnonKey: process.env.EXPO_PUBLIC_SUPABASE_ANON_KEY || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndibHRzYnlqbnlyYWVhcXVta2N1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzgzNzM1ODksImV4cCI6MjA1Mzk0OTU4OX0.gMqIQ7xIC2zSiwDbbdt6RClZMIkSDQqIJxYzAtdcziY',
};
EOF

cat > services/supabaseClient.js << 'EOF'
import { createClient } from '@supabase/supabase-js';
import { APP_CONFIG } from '../config/config';

const supabaseUrl = APP_CONFIG.supabaseUrl;
const supabaseAnonKey = APP_CONFIG.supabaseAnonKey;

export const supabase = createClient(supabaseUrl, supabaseAnonKey);
EOF

cat > services/apiService.js << 'EOF'
import { supabase } from './supabaseClient';

// Posts API
export const fetchPosts = async () => {
  const { data, error } = await supabase.from('posts').select('*').order('created_at', { ascending: false });
  if (error) {
    console.error('Error fetching posts:', error);
    throw error;
  }
  return data;
};

export const createPost = async (content) => {
  const { data, error } = await supabase.from('posts').insert([{ content }]);
  if (error) {
    console.error('Error creating post:', error);
    throw error;
  }
  return data;
};

// Chats API
export const fetchChats = async () => {
  const { data, error } = await supabase.from('chats').select('*').order('created_at');
  if (error) {
    console.error('Error fetching chats:', error);
    throw error;
  }
  return data;
};

export const createChatMessage = async (message) => {
  const { data, error } = await supabase.from('chats').insert([{ message }]);
  if (error) {
    console.error('Error creating chat message:', error);
    throw error;
  }
  return data;
};
EOF

# Step 3: Create component files
cat > components/AdminDashboard.js << 'EOF'
import React, { useContext } from 'react';
import { View, Text, Button } from 'react-native';
import { UserContext } from '../contexts/UserContext';

const AdminDashboard = () => {
  const { role } = useContext(UserContext);

  if (role !== 'admin') {
    return (
      <View className="p-4">
        <Text className="text-red-500 text-xl">Access Denied</Text>
        <Text>You do not have admin privileges.</Text>
      </View>
    );
  }

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">Admin Dashboard</Text>
      <Button title="Refresh Data" onPress={() => { /* Refresh logic here */ }} />
    </View>
  );
};

export default AdminDashboard;
EOF

cat > components/PostList.js << 'EOF'
import React, { useEffect, useState } from 'react';
import { View, Text, FlatList, Button } from 'react-native';
import { fetchPosts, createPost } from '../services/apiService';

const PostList = () => {
  const [posts, setPosts] = useState([]);

  const loadPosts = async () => {
    try {
      const data = await fetchPosts();
      setPosts(data);
    } catch (error) {
      console.error('Error loading posts:', error);
    }
  };

  useEffect(() => {
    loadPosts();
  }, []);

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">Posts</Text>
      <FlatList
        data={posts}
        keyExtractor={(item) => item.id}
        renderItem={({ item }) => (
          <View className="mb-2 p-2 border rounded">
            <Text>{item.content}</Text>
          </View>
        )}
      />
      <Button title="New Post" onPress={() => createPost("Sample post content").then(loadPosts)} />
    </View>
  );
};

export default PostList;
EOF

cat > components/ChatComponent.js << 'EOF'
import React, { useEffect, useState } from 'react';
import { View, Text, FlatList, TextInput, Button } from 'react-native';
import { supabase } from '../services/supabaseClient';
import { createChatMessage, fetchChats } from '../services/apiService';

const ChatComponent = () => {
  const [messages, setMessages] = useState([]);
  const [newMessage, setNewMessage] = useState('');

  const loadMessages = async () => {
    try {
      const data = await fetchChats();
      setMessages(data);
    } catch (error) {
      console.error('Error loading messages:', error);
    }
  };

  const sendMessage = async () => {
    if (!newMessage) return;
    try {
      await createChatMessage(newMessage);
      setNewMessage('');
    } catch (error) {
      console.error('Error sending message:', error);
    }
  };

  useEffect(() => {
    loadMessages();
    const subscription = supabase
      .from('chats')
      .on('INSERT', payload => {
        setMessages((prev) => [...prev, payload.new]);
      })
      .subscribe();

    return () => {
      supabase.removeSubscription(subscription);
    };
  }, []);

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">Chat</Text>
      <FlatList
        data={messages}
        keyExtractor={(item) => item.id}
        renderItem={({ item }) => (
          <View className="mb-2 p-2 border rounded">
            <Text>{item.message}</Text>
          </View>
        )}
      />
      <TextInput 
        value={newMessage}
        onChangeText={setNewMessage}
        placeholder="Type your message..."
        className="border p-2 mb-2"
      />
      <Button title="Send" onPress={sendMessage} />
    </View>
  );
};

export default ChatComponent;
EOF

cat > components/CrudInterface.js << 'EOF'
import React, { useState, useEffect } from 'react';
import { View, Text, TextInput, Button, FlatList } from 'react-native';
import { supabase } from '../services/supabaseClient';

const CrudInterface = () => {
  const [items, setItems] = useState([]);
  const [newItem, setNewItem] = useState('');
  const [editItemId, setEditItemId] = useState(null);
  const [editText, setEditText] = useState('');

  const fetchItems = async () => {
    const { data, error } = await supabase
      .from('crud_items')
      .select('*')
      .order('created_at', { ascending: false });
    if (error) {
      console.error('Error fetching items:', error);
    } else {
      setItems(data);
    }
  };

  const createItem = async () => {
    if (!newItem) return;
    const { data, error } = await supabase
      .from('crud_items')
      .insert([{ content: newItem }]);
    if (error) {
      console.error('Error creating item:', error);
    } else {
      setNewItem('');
      fetchItems();
    }
  };

  const updateItem = async () => {
    if (!editText || !editItemId) return;
    const { data, error } = await supabase
      .from('crud_items')
      .update({ content: editText })
      .eq('id', editItemId);
    if (error) {
      console.error('Error updating item:', error);
    } else {
      setEditItemId(null);
      setEditText('');
      fetchItems();
    }
  };

  const deleteItem = async (id) => {
    const { data, error } = await supabase
      .from('crud_items')
      .delete()
      .eq('id', id);
    if (error) {
      console.error('Error deleting item:', error);
    } else {
      fetchItems();
    }
  };

  useEffect(() => {
    fetchItems();
  }, []);

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">CRUD Scaffolding Interface</Text>
      <TextInput 
        value={newItem}
        onChangeText={setNewItem}
        placeholder="New item content"
        className="border p-2 mb-2"
      />
      <Button title="Add Item" onPress={createItem} />
      <FlatList
        data={items}
        keyExtractor={(item) => item.id}
        renderItem={({ item }) => (
          <View className="my-2 p-2 border rounded">
            <Text>{item.content}</Text>
            <Button title="Edit" onPress={() => { setEditItemId(item.id); setEditText(item.content); }} />
            <Button title="Delete" onPress={() => deleteItem(item.id)} />
          </View>
        )}
      />
      {editItemId && (
        <View className="mt-4">
          <Text>Edit Item</Text>
          <TextInput 
            value={editText}
            onChangeText={setEditText}
            placeholder="Edit item content"
            className="border p-2 mb-2"
          />
          <Button title="Update Item" onPress={updateItem} />
        </View>
      )}
    </View>
  );
};

export default CrudInterface;
EOF

# Step 4: Create Expo Router files in the app folder
mkdir -p app/admin

# Global layout for Expo Router (app/_layout.js)
cat > app/_layout.js << 'EOF'
import React from 'react';
import { Slot } from 'expo-router';
import { View, Text } from 'react-native';

export default function RootLayout() {
  return (
    <View style={{ flex: 1 }}>
      <Text style={{ padding: 16, fontSize: 24 }}>ScriptHammer</Text>
      <Slot />
    </View>
  );
}
EOF

# Home screen (app/index.js) - IMPORTANT: Replace default contents of app/index.js!
cat > app/index.js << 'EOF'
import React from 'react';
import { View } from 'react-native';
import PostList from '../components/PostList';
import ChatComponent from '../components/ChatComponent';
import CrudInterface from '../components/CrudInterface';

export default function HomeScreen() {
  return (
    <View style={{ flex: 1, padding: 16 }}>
      <PostList />
      <ChatComponent />
      <CrudInterface />
    </View>
  );
}
EOF

# Admin route screen (app/admin/index.js)
cat > app/admin/index.js << 'EOF'
import React from 'react';
import AdminDashboard from '../../components/AdminDashboard';

export default function AdminScreen() {
  return <AdminDashboard />;
}
EOF

# Step 5: Create Storybook and test files
mkdir -p .storybook tests

cat > .storybook/main.js << 'EOF'
module.exports = {
  stories: ['../components/**/*.stories.@(js|jsx|ts|tsx)'],
  addons: [
    '@storybook/addon-links',
    '@storybook/addon-essentials',
  ],
};
EOF

cat > tests/App.test.js << 'EOF'
import React from 'react';
import renderer from 'react-test-renderer';
import RootLayout from '../app/_layout';

it('renders correctly', () => {
  const tree = renderer.create(<RootLayout />).toJSON();
  expect(tree).toMatchSnapshot();
});
EOF

cat > jest.config.js << 'EOF'
module.exports = {
  preset: 'jest-expo',
  transform: {
    '^.+\\.js$': '<rootDir>/node_modules/react-native/jest/preprocessor.js',
  },
  setupFiles: ['./tests/jest.setup.js'],
};
EOF

cat > tests/jest.setup.js << 'EOF'
import 'react-native-gesture-handler/jestSetup';
EOF

echo "Project setup complete."
echo "IMPORTANT: Run the Supabase SQL commands from Section 1 in your Supabase dashboard."
exit 0
```

---

## 8. Recommended Folder Structure

After following this tutorial, your project should have a structure similar to:

```plaintext
ScriptHammer/
├── app/
│   ├── _layout.js             # Global layout and navigation for Expo Router
│   ├── index.js               # Home screen (custom HomeScreen; default contents replaced)
│   └── admin/
│       └── index.js           # Admin dashboard screen (/admin)
├── assets/                    # Static assets (images, fonts, etc.)
├── components/
│   ├── AdminDashboard.js
│   ├── ChatComponent.js
│   ├── CrudInterface.js
│   ├── PostList.js
│   └── Button.stories.js      # Storybook stories for components
├── config/
│   └── config.js              # Global configuration (environment variables)
├── contexts/
│   └── UserContext.js         # User context for authentication/roles
├── services/
│   ├── apiService.js          # API service for Supabase calls
│   └── supabaseClient.js      # Supabase client initialization
├── .storybook/
│   └── main.js                # Storybook configuration
├── tests/
│   ├── App.test.js            # Snapshot test for the root layout
│   └── jest.setup.js          # Jest setup file
├── jest.config.js             # Jest configuration
├── package.json               # Project dependencies and scripts
└── README.md                  # Project documentation
```

---

By following this tutorial—with the critical HomeScreen update (in **app/index.js**) moved into Section 2.2—you will have built a robust mobile app framework that:

- **Integrates Supabase** for backend authentication, role management, and data storage.
- **Uses Expo Router** with a modern **app/** directory, where **app/index.js** is replaced with your custom HomeScreen.
- **Applies NativeWind** for styling.
- **Supports Storybook** for isolated UI component development.
- **Includes Jest testing** for critical application paths.
- **Provides a dynamic CRUD scaffolding interface.**

This version ensures the important step of updating **app/index.js** is clearly addressed early on, so there's no ambiguity about replacing the default content. Happy coding!
