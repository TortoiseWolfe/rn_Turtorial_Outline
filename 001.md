Below is the complete, up‑to‑date tutorial for building your mobile app framework using Expo Router, Supabase, NativeWind, Storybook, and Jest testing. This guide has been re‑ordered so that the Supabase backend setup comes first, and it uses the modern folder structure (with the **app/** directory) that replaces the old **App.js** file. Each section includes complete, functional code blocks that you can copy and paste into your project files. A clickable table of contents at the top helps you navigate the tutorial, and a terminal script is provided at the end to quickly set up your project structure.

> **Note:** Before proceeding, run the Supabase SQL commands in your Supabase dashboard to configure authentication, role assignment, and the initial database schema.

---

# Table of Contents

- [1. Supabase Integration & Backend Setup](#1-supabase-integration--backend-setup)
  - [1.1 Authentication and Role Assignment](#11-authentication-and-role-assignment)
  - [1.2 Database Schema and API Service Layer](#12-database-schema-and-api-service-layer)
- [2. Initial Expo Setup & Configuration](#2-initial-expo-setup--configuration)
- [3. Building the Admin Dashboard](#3-building-the-admin-dashboard)
- [4. Implementing Social Network Features](#4-implementing-social-network-features)
  - [4.1 Posts Component](#41-posts-component)
  - [4.2 Chat Component](#42-chat-component)
- [5. Developer Experience Tools](#5-developer-experience-tools)
  - [5.1 Storybook Setup](#51-storybook-setup)
  - [5.2 Testing Setup](#52-testing-setup)
- [6. CRUD Scaffolding Interface](#6-crud-scaffolding-interface)
- [7. Terminal Setup Script](#7-terminal-setup-script)
- [8. Recommended Folder Structure](#8-recommended-folder-structure)

---

## 1. Supabase Integration & Backend Setup

### 1.1 Authentication and Role Assignment

Run the following SQL commands in your Supabase dashboard to create a table for user roles and a trigger that automatically assigns roles. The very first user gets the "admin" role, and all subsequent users are assigned "user".

```sql
-- Create a table for user roles
create table if not exists public.user_roles (
  user_id uuid primary key,
  role text not null,
  created_at timestamp with time zone default now()
);

-- Create a function to assign roles automatically
create or replace function public.assign_role()
returns trigger as $$
declare
  admin_count int;
begin
  select count(*) into admin_count from public.user_roles where role = 'admin';
  if admin_count = 0 then
    insert into public.user_roles(user_id, role) values (new.id, 'admin');
  else
    insert into public.user_roles(user_id, role) values (new.id, 'user');
  end if;
  return new;
end;
$$ language plpgsql;

-- Create the trigger to call the function after user insertion
drop trigger if exists assign_role_trigger on auth.users;
create trigger assign_role_trigger
after insert on auth.users
for each row execute function public.assign_role();
```

### 1.2 Database Schema and API Service Layer

Also, run these SQL commands in your Supabase dashboard to create tables for posts, chats, and a CRUD operations table:

```sql
-- Create posts table
create table if not exists public.posts (
  id uuid primary key default gen_random_uuid(),
  user_id uuid references auth.users(id),
  content text not null,
  created_at timestamp with time zone default now()
);

-- Create chats table
create table if not exists public.chats (
  id uuid primary key default gen_random_uuid(),
  sender_id uuid references auth.users(id),
  receiver_id uuid references auth.users(id),
  message text not null,
  created_at timestamp with time zone default now()
);

-- Create table for CRUD operations
create table if not exists public.crud_items (
  id uuid primary key default gen_random_uuid(),
  content text not null,
  created_at timestamp with time zone default now()
);
```

Now, add the service layer file to your project for API calls. Create a file named **services/apiService.js** with the following content:

```javascript
// services/apiService.js
import { supabase } from './supabaseClient';

// Posts API
export const fetchPosts = async () => {
  const { data, error } = await supabase
    .from('posts')
    .select('*')
    .order('created_at', { ascending: false });
  if (error) {
    console.error('Error fetching posts:', error);
    throw error;
  }
  return data;
};

export const createPost = async (content) => {
  const { data, error } = await supabase
    .from('posts')
    .insert([{ content }]);
  if (error) {
    console.error('Error creating post:', error);
    throw error;
  }
  return data;
};

// Chats API
export const fetchChats = async () => {
  const { data, error } = await supabase
    .from('chats')
    .select('*')
    .order('created_at');
  if (error) {
    console.error('Error fetching chats:', error);
    throw error;
  }
  return data;
};

export const createChatMessage = async (message) => {
  const { data, error } = await supabase
    .from('chats')
    .insert([{ message }]);
  if (error) {
    console.error('Error creating chat message:', error);
    throw error;
  }
  return data;
};
```

Also, create the Supabase client file **services/supabaseClient.js**:

```javascript
// services/supabaseClient.js
import { createClient } from '@supabase/supabase-js';
import { APP_CONFIG } from '../config/config';

const supabaseUrl = APP_CONFIG.supabaseUrl;
const supabaseAnonKey = APP_CONFIG.supabaseAnonKey;

export const supabase = createClient(supabaseUrl, supabaseAnonKey);
```

---

## 2. Initial Expo Setup & Configuration

Now initialize your Expo project using Expo Router. Run these commands in your terminal:

```bash
npx create-expo-app ScriptHammer
cd ScriptHammer
npm run reset-project
rm -rf app-example
```

Create a configuration file at **config/config.js** that uses the proper environment variable names and full values:

```javascript
// config/config.js
export const APP_CONFIG = {
  projectName: 'ScriptHammer',
  supabaseUrl: process.env.EXPO_PUBLIC_SUPABASE_URL || 'https://wbltsbyjnyraeaqumkcu.supabase.co',
  supabaseAnonKey: process.env.EXPO_PUBLIC_SUPABASE_ANON_KEY || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndibHRzYnlqbnlyYWVhcXVta2N1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzgzNzM1ODksImV4cCI6MjA1Mzk0OTU4OX0.gMqIQ7xIC2zSiwDbbdt6RClZMIkSDQqIJxYzAtdcziY',
};
```

---

## 3. Building the Admin Dashboard

Create a reusable component for the admin dashboard in **components/AdminDashboard.js**. (Assume you have a React Context named **UserContext** for user roles.)

```javascript
// components/AdminDashboard.js
import React, { useContext } from 'react';
import { View, Text, Button } from 'react-native';
import { UserContext } from '../contexts/UserContext';

const AdminDashboard = () => {
  const { role } = useContext(UserContext);

  if (role !== 'admin') {
    return (
      <View className="p-4">
        <Text className="text-red-500 text-xl">Access Denied</Text>
        <Text>You do not have admin privileges.</Text>
      </View>
    );
  }

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">Admin Dashboard</Text>
      <Button title="Refresh Data" onPress={() => { /* Refresh logic here */ }} />
    </View>
  );
};

export default AdminDashboard;
```

You can then integrate this component into an admin route. For example, create **app/admin/index.js**:

```javascript
// app/admin/index.js
import React from 'react';
import AdminDashboard from '../../components/AdminDashboard';

export default function AdminScreen() {
  return <AdminDashboard />;
}
```

---

## 4. Implementing Social Network Features

### 4.1 Posts Component

Create **components/PostList.js** for listing and creating posts:

```javascript
// components/PostList.js
import React, { useEffect, useState } from 'react';
import { View, Text, FlatList, Button } from 'react-native';
import { fetchPosts, createPost } from '../services/apiService';

const PostList = () => {
  const [posts, setPosts] = useState([]);

  const loadPosts = async () => {
    try {
      const data = await fetchPosts();
      setPosts(data);
    } catch (error) {
      console.error('Error loading posts:', error);
    }
  };

  useEffect(() => {
    loadPosts();
  }, []);

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">Posts</Text>
      <FlatList
        data={posts}
        keyExtractor={(item) => item.id}
        renderItem={({ item }) => (
          <View className="mb-2 p-2 border rounded">
            <Text>{item.content}</Text>
          </View>
        )}
      />
      <Button title="New Post" onPress={() => createPost("Sample post content").then(loadPosts)} />
    </View>
  );
};

export default PostList;
```

### 4.2 Chat Component

Create **components/ChatComponent.js** for a real‑time chat interface using Supabase subscriptions:

```javascript
// components/ChatComponent.js
import React, { useEffect, useState } from 'react';
import { View, Text, FlatList, TextInput, Button } from 'react-native';
import { supabase } from '../services/supabaseClient';
import { createChatMessage, fetchChats } from '../services/apiService';

const ChatComponent = () => {
  const [messages, setMessages] = useState([]);
  const [newMessage, setNewMessage] = useState('');

  const loadMessages = async () => {
    try {
      const data = await fetchChats();
      setMessages(data);
    } catch (error) {
      console.error('Error loading messages:', error);
    }
  };

  const sendMessage = async () => {
    if (!newMessage) return;
    try {
      await createChatMessage(newMessage);
      setNewMessage('');
    } catch (error) {
      console.error('Error sending message:', error);
    }
  };

  useEffect(() => {
    loadMessages();
    const subscription = supabase
      .from('chats')
      .on('INSERT', payload => {
        setMessages((prev) => [...prev, payload.new]);
      })
      .subscribe();

    return () => {
      supabase.removeSubscription(subscription);
    };
  }, []);

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">Chat</Text>
      <FlatList
        data={messages}
        keyExtractor={(item) => item.id}
        renderItem={({ item }) => (
          <View className="mb-2 p-2 border rounded">
            <Text>{item.message}</Text>
          </View>
        )}
      />
      <TextInput 
        value={newMessage}
        onChangeText={setNewMessage}
        placeholder="Type your message..."
        className="border p-2 mb-2"
      />
      <Button title="Send" onPress={sendMessage} />
    </View>
  );
};

export default ChatComponent;
```

---

## 5. Developer Experience Tools

### 5.1 Storybook Setup

Set up Storybook by creating **.storybook/main.js**:

```javascript
// .storybook/main.js
module.exports = {
  stories: ['../components/**/*.stories.@(js|jsx|ts|tsx)'],
  addons: [
    '@storybook/addon-links',
    '@storybook/addon-essentials',
  ],
};
```

Then add an initial story in **components/Button.stories.js**:

```javascript
// components/Button.stories.js
import React from 'react';
import { Button } from 'react-native';
import { storiesOf } from '@storybook/react-native';

storiesOf('Button', module)
  .add('default', () => (
    <Button title="Click Me" onPress={() => {}} />
  ));
```

### 5.2 Testing Setup

Configure Jest by adding the following files:

**tests/App.test.js**

```javascript
// tests/App.test.js
import React from 'react';
import renderer from 'react-test-renderer';
import { registerRootComponent } from 'expo';
import App from '../app/_layout';

it('renders correctly', () => {
  const tree = renderer.create(<App />).toJSON();
  expect(tree).toMatchSnapshot();
});
```

**jest.config.js**

```javascript
// jest.config.js
module.exports = {
  preset: 'jest-expo',
  transform: {
    '^.+\\.js$': '<rootDir>/node_modules/react-native/jest/preprocessor.js',
  },
  setupFiles: ['./tests/jest.setup.js'],
};
```

**tests/jest.setup.js**

```javascript
// tests/jest.setup.js
import 'react-native-gesture-handler/jestSetup';
```

---

## 6. CRUD Scaffolding Interface

Create a dynamic CRUD interface in **components/CrudInterface.js**:

```javascript
// components/CrudInterface.js
import React, { useState, useEffect } from 'react';
import { View, Text, TextInput, Button, FlatList } from 'react-native';
import { supabase } from '../services/supabaseClient';

const CrudInterface = () => {
  const [items, setItems] = useState([]);
  const [newItem, setNewItem] = useState('');
  const [editItemId, setEditItemId] = useState(null);
  const [editText, setEditText] = useState('');

  const fetchItems = async () => {
    const { data, error } = await supabase
      .from('crud_items')
      .select('*')
      .order('created_at', { ascending: false });
    if (error) {
      console.error('Error fetching items:', error);
    } else {
      setItems(data);
    }
  };

  const createItem = async () => {
    if (!newItem) return;
    const { data, error } = await supabase
      .from('crud_items')
      .insert([{ content: newItem }]);
    if (error) {
      console.error('Error creating item:', error);
    } else {
      setNewItem('');
      fetchItems();
    }
  };

  const updateItem = async () => {
    if (!editText || !editItemId) return;
    const { data, error } = await supabase
      .from('crud_items')
      .update({ content: editText })
      .eq('id', editItemId);
    if (error) {
      console.error('Error updating item:', error);
    } else {
      setEditItemId(null);
      setEditText('');
      fetchItems();
    }
  };

  const deleteItem = async (id) => {
    const { data, error } = await supabase
      .from('crud_items')
      .delete()
      .eq('id', id);
    if (error) {
      console.error('Error deleting item:', error);
    } else {
      fetchItems();
    }
  };

  useEffect(() => {
    fetchItems();
  }, []);

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">CRUD Scaffolding Interface</Text>
      <TextInput 
        value={newItem}
        onChangeText={setNewItem}
        placeholder="New item content"
        className="border p-2 mb-2"
      />
      <Button title="Add Item" onPress={createItem} />
      <FlatList
        data={items}
        keyExtractor={(item) => item.id}
        renderItem={({ item }) => (
          <View className="my-2 p-2 border rounded">
            <Text>{item.content}</Text>
            <Button title="Edit" onPress={() => { setEditItemId(item.id); setEditText(item.content); }} />
            <Button title="Delete" onPress={() => deleteItem(item.id)} />
          </View>
        )}
      />
      {editItemId && (
        <View className="mt-4">
          <Text>Edit Item</Text>
          <TextInput 
            value={editText}
            onChangeText={setEditText}
            placeholder="Edit item content"
            className="border p-2 mb-2"
          />
          <Button title="Update Item" onPress={updateItem} />
        </View>
      )}
    </View>
  );
};

export default CrudInterface;
```

---

## 7. Terminal Setup Script

Below is a shell script that creates the complete project structure and files for you. Copy and paste it into your terminal. (Remember: Run the Supabase SQL commands manually in your Supabase dashboard.)

```bash
#!/bin/bash
# --- Terminal Setup Script for ScriptHammer Mobile App Framework ---

# Step 1: Create and setup the Expo project with Expo Router
npx create-expo-app ScriptHammer
cd ScriptHammer
npm run reset-project
rm -rf app-example

# Step 2: Create configuration and Supabase client files
mkdir -p config services components app/contexts app/tests

cat > config/config.js << 'EOF'
export const APP_CONFIG = {
  projectName: 'ScriptHammer',
  supabaseUrl: process.env.EXPO_PUBLIC_SUPABASE_URL || 'https://wbltsbyjnyraeaqumkcu.supabase.co',
  supabaseAnonKey: process.env.EXPO_PUBLIC_SUPABASE_ANON_KEY || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndibHRzYnlqbnlyYWVhcXVta2N1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzgzNzM1ODksImV4cCI6MjA1Mzk0OTU4OX0.gMqIQ7xIC2zSiwDbbdt6RClZMIkSDQqIJxYzAtdcziY',
};
EOF

cat > services/supabaseClient.js << 'EOF'
import { createClient } from '@supabase/supabase-js';
import { APP_CONFIG } from '../config/config';

const supabaseUrl = APP_CONFIG.supabaseUrl;
const supabaseAnonKey = APP_CONFIG.supabaseAnonKey;

export const supabase = createClient(supabaseUrl, supabaseAnonKey);
EOF

cat > services/apiService.js << 'EOF'
import { supabase } from './supabaseClient';

// Posts API
export const fetchPosts = async () => {
  const { data, error } = await supabase.from('posts').select('*').order('created_at', { ascending: false });
  if (error) {
    console.error('Error fetching posts:', error);
    throw error;
  }
  return data;
};

export const createPost = async (content) => {
  const { data, error } = await supabase.from('posts').insert([{ content }]);
  if (error) {
    console.error('Error creating post:', error);
    throw error;
  }
  return data;
};

// Chats API
export const fetchChats = async () => {
  const { data, error } = await supabase.from('chats').select('*').order('created_at');
  if (error) {
    console.error('Error fetching chats:', error);
    throw error;
  }
  return data;
};

export const createChatMessage = async (message) => {
  const { data, error } = await supabase.from('chats').insert([{ message }]);
  if (error) {
    console.error('Error creating chat message:', error);
    throw error;
  }
  return data;
};
EOF

# Step 3: Create component files
cat > components/AdminDashboard.js << 'EOF'
import React, { useContext } from 'react';
import { View, Text, Button } from 'react-native';
import { UserContext } from '../contexts/UserContext';

const AdminDashboard = () => {
  const { role } = useContext(UserContext);

  if (role !== 'admin') {
    return (
      <View className="p-4">
        <Text className="text-red-500 text-xl">Access Denied</Text>
        <Text>You do not have admin privileges.</Text>
      </View>
    );
  }

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">Admin Dashboard</Text>
      <Button title="Refresh Data" onPress={() => { /* Refresh logic here */ }} />
    </View>
  );
};

export default AdminDashboard;
EOF

cat > components/PostList.js << 'EOF'
import React, { useEffect, useState } from 'react';
import { View, Text, FlatList, Button } from 'react-native';
import { fetchPosts, createPost } from '../services/apiService';

const PostList = () => {
  const [posts, setPosts] = useState([]);

  const loadPosts = async () => {
    try {
      const data = await fetchPosts();
      setPosts(data);
    } catch (error) {
      console.error('Error loading posts:', error);
    }
  };

  useEffect(() => {
    loadPosts();
  }, []);

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">Posts</Text>
      <FlatList
        data={posts}
        keyExtractor={(item) => item.id}
        renderItem={({ item }) => (
          <View className="mb-2 p-2 border rounded">
            <Text>{item.content}</Text>
          </View>
        )}
      />
      <Button title="New Post" onPress={() => createPost("Sample post content").then(loadPosts)} />
    </View>
  );
};

export default PostList;
EOF

cat > components/ChatComponent.js << 'EOF'
import React, { useEffect, useState } from 'react';
import { View, Text, FlatList, TextInput, Button } from 'react-native';
import { supabase } from '../services/supabaseClient';
import { createChatMessage, fetchChats } from '../services/apiService';

const ChatComponent = () => {
  const [messages, setMessages] = useState([]);
  const [newMessage, setNewMessage] = useState('');

  const loadMessages = async () => {
    try {
      const data = await fetchChats();
      setMessages(data);
    } catch (error) {
      console.error('Error loading messages:', error);
    }
  };

  const sendMessage = async () => {
    if (!newMessage) return;
    try {
      await createChatMessage(newMessage);
      setNewMessage('');
    } catch (error) {
      console.error('Error sending message:', error);
    }
  };

  useEffect(() => {
    loadMessages();
    const subscription = supabase
      .from('chats')
      .on('INSERT', payload => {
        setMessages((prev) => [...prev, payload.new]);
      })
      .subscribe();

    return () => {
      supabase.removeSubscription(subscription);
    };
  }, []);

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">Chat</Text>
      <FlatList
        data={messages}
        keyExtractor={(item) => item.id}
        renderItem={({ item }) => (
          <View className="mb-2 p-2 border rounded">
            <Text>{item.message}</Text>
          </View>
        )}
      />
      <TextInput 
        value={newMessage}
        onChangeText={setNewMessage}
        placeholder="Type your message..."
        className="border p-2 mb-2"
      />
      <Button title="Send" onPress={sendMessage} />
    </View>
  );
};

export default ChatComponent;
EOF

cat > components/CrudInterface.js << 'EOF'
import React, { useState, useEffect } from 'react';
import { View, Text, TextInput, Button, FlatList } from 'react-native';
import { supabase } from '../services/supabaseClient';

const CrudInterface = () => {
  const [items, setItems] = useState([]);
  const [newItem, setNewItem] = useState('');
  const [editItemId, setEditItemId] = useState(null);
  const [editText, setEditText] = useState('');

  const fetchItems = async () => {
    const { data, error } = await supabase
      .from('crud_items')
      .select('*')
      .order('created_at', { ascending: false });
    if (error) {
      console.error('Error fetching items:', error);
    } else {
      setItems(data);
    }
  };

  const createItem = async () => {
    if (!newItem) return;
    const { data, error } = await supabase
      .from('crud_items')
      .insert([{ content: newItem }]);
    if (error) {
      console.error('Error creating item:', error);
    } else {
      setNewItem('');
      fetchItems();
    }
  };

  const updateItem = async () => {
    if (!editText || !editItemId) return;
    const { data, error } = await supabase
      .from('crud_items')
      .update({ content: editText })
      .eq('id', editItemId);
    if (error) {
      console.error('Error updating item:', error);
    } else {
      setEditItemId(null);
      setEditText('');
      fetchItems();
    }
  };

  const deleteItem = async (id) => {
    const { data, error } = await supabase
      .from('crud_items')
      .delete()
      .eq('id', id);
    if (error) {
      console.error('Error deleting item:', error);
    } else {
      fetchItems();
    }
  };

  useEffect(() => {
    fetchItems();
  }, []);

  return (
    <View className="p-4">
      <Text className="text-2xl font-bold mb-4">CRUD Scaffolding Interface</Text>
      <TextInput 
        value={newItem}
        onChangeText={setNewItem}
        placeholder="New item content"
        className="border p-2 mb-2"
      />
      <Button title="Add Item" onPress={createItem} />
      <FlatList
        data={items}
        keyExtractor={(item) => item.id}
        renderItem={({ item }) => (
          <View className="my-2 p-2 border rounded">
            <Text>{item.content}</Text>
            <Button title="Edit" onPress={() => { setEditItemId(item.id); setEditText(item.content); }} />
            <Button title="Delete" onPress={() => deleteItem(item.id)} />
          </View>
        )}
      />
      {editItemId && (
        <View className="mt-4">
          <Text>Edit Item</Text>
          <TextInput 
            value={editText}
            onChangeText={setEditText}
            placeholder="Edit item content"
            className="border p-2 mb-2"
          />
          <Button title="Update Item" onPress={updateItem} />
        </View>
      )}
    </View>
  );
};

export default CrudInterface;
EOF

# Step 4: Create Expo Router files in the app folder
mkdir -p app/admin

# Global layout for Expo Router
cat > app/_layout.js << 'EOF'
import React from 'react';
import { Slot } from 'expo-router';
import { View, Text } from 'react-native';

export default function RootLayout() {
  return (
    <View style={{ flex: 1 }}>
      <Text style={{ padding: 16, fontSize: 24 }}>ScriptHammer</Text>
      <Slot />
    </View>
  );
}
EOF

# Home screen (index) in app folder
cat > app/index.js << 'EOF'
import React from 'react';
import { View, Text } from 'react-native';
import PostList from '../components/PostList';
import ChatComponent from '../components/ChatComponent';
import CrudInterface from '../components/CrudInterface';

export default function HomeScreen() {
  return (
    <View style={{ flex: 1, padding: 16 }}>
      <PostList />
      <ChatComponent />
      <CrudInterface />
    </View>
  );
}
EOF

# Admin route screen in app/admin/index.js
cat > app/admin/index.js << 'EOF'
import React from 'react';
import AdminDashboard from '../../components/AdminDashboard';

export default function AdminScreen() {
  return <AdminDashboard />;
}
EOF

# Step 5: Create Storybook and test files
mkdir -p .storybook tests

cat > .storybook/main.js << 'EOF'
module.exports = {
  stories: ['../components/**/*.stories.@(js|jsx|ts|tsx)'],
  addons: [
    '@storybook/addon-links',
    '@storybook/addon-essentials',
  ],
};
EOF

cat > tests/App.test.js << 'EOF'
import React from 'react';
import renderer from 'react-test-renderer';
import RootLayout from '../app/_layout';

it('renders correctly', () => {
  const tree = renderer.create(<RootLayout />).toJSON();
  expect(tree).toMatchSnapshot();
});
EOF

cat > jest.config.js << 'EOF'
module.exports = {
  preset: 'jest-expo',
  transform: {
    '^.+\\.js$': '<rootDir>/node_modules/react-native/jest/preprocessor.js',
  },
  setupFiles: ['./tests/jest.setup.js'],
};
EOF

cat > tests/jest.setup.js << 'EOF'
import 'react-native-gesture-handler/jestSetup';
EOF

echo "Project setup complete."
echo "IMPORTANT: Run the Supabase SQL commands from Section 1 in your Supabase dashboard."
```

---

## 8. Recommended Folder Structure

After following this tutorial, your project structure should resemble the following:

```plaintext
ScriptHammer/
├── app/
│   ├── _layout.js             # Global layout and navigation for Expo Router
│   ├── index.js               # Home screen (default route)
│   └── admin/
│       └── index.js           # Admin dashboard screen (/admin)
├── assets/                    # Static assets (images, fonts, etc.)
├── components/
│   ├── AdminDashboard.js
│   ├── ChatComponent.js
│   ├── CrudInterface.js
│   ├── PostList.js
│   └── Button.stories.js      # Storybook stories
├── config/
│   └── config.js              # Global configuration (env variables)
├── contexts/
│   └── UserContext.js         # User context for authentication/roles
├── services/
│   ├── apiService.js          # API service for Supabase calls
│   └── supabaseClient.js      # Supabase client initialization
├── .storybook/
│   └── main.js                # Storybook configuration
├── tests/
│   ├── App.test.js            # Snapshot test for the root layout
│   └── jest.setup.js          # Jest setup file
├── jest.config.js             # Jest configuration
├── package.json               # Project dependencies and scripts
└── README.md                  # Project documentation
```

---

By following this complete, up‑to‑date tutorial, you will have built a robust mobile app framework that: 

- **Integrates Supabase** for backend authentication, role management, and data storage;  
- **Uses Expo Router** for modern navigation without relying on the old App.js file;  
- **Applies NativeWind** for global styling (including system-based dark/light mode);  
- **Supports Storybook** for isolated UI component development;  
- **Includes Jest testing** for critical application paths; and  
- **Provides a dynamic CRUD scaffolding interface.**

Remember to incrementally test each module and maintain the integrity of your existing codebase as you integrate these features. Happy coding!
